\subsection{Isosurface extraction\pavol{update plot text to isosurface}}\label{sec:isocontour}
Extraction of isosurfaces is an essential task in any visualization and analysis system. For
example, in a combustion simulation, isosurfaces of OH concentration can separate burning and
extinguished regions. In medical imaging, organs can also be separated from the background with
isosurface extraction. Beyond visualization, topological methods such as Reeb Graph [CITE] is built
from equivalence classes of isosurfaces.

In attempting to define an error metric to compare isosurfaces, we have found that the popular
Hausdorff distance [CITE] is not very robust --- it varies drastically with minor changes in the
surfaces. ore, we use a number of misclassified voxels as our distance which can be computed by
counting all voxels that are either in surface $S_1$ and not surface $S_2$ or the other way.
\pavol{not sure if following is needed}We have found that if the error caused by switching off a
chunk is too small (in orders of sub-pixel/sub-voxel), then the importance of the chunk cannot be
properly measured. We therefore amend the error metric by adding to it the relative difference in
area between two isosurfaces. This relative difference is, most of the time, a number between $0$
and $1$, computed by the formula $|A(S_1)-A(S_2)|/A(S_1)$, where $A(S)$ is the area of an isosurface
$S$. The idea is that when the number number of misclassified voxels is less than $1$, the error --
which is at the sub-voxel level -- is captured by the relative difference in contour length instead.

With an error metric defined, we can compute an \emph{isosurface-optimized} stream for each data set
in addition to the other streams that are data independent (\Cref{fig:isocontour-plots}). The
hypothesis is resolving an isosurface is primarily affected by the domain resolution. Both
resolution and precision streams are bounded by Nquist limit, a fine isosurface detail may fail to
be resolved either due low resolution or precision. As expected, the {\em isosurface-optimize}
stream performs the best as it has the most freedom when reordering chunks. We observed close to no
difference between {\em by bit plane}, {\em by wavelet norm}, and {\em isosurface signature}
streams. This result is primarily caused by the need for resolution when extracting isosurfaces. For
example, {\em by bit plane} stream will always load full resolution data and vary only precision.

\begin{figure}[t]
	\centering
	\subcaptionbox{pressure}
	{\includegraphics[width=0.48\linewidth]{isocontour/isocontour-optimized-pressure}}
	\subcaptionbox{turbulence}
	{\includegraphics[width=0.48\linewidth]{isocontour/isocontour-optimized-turbulence}}
	\subcaptionbox{plasma}
	{\includegraphics[width=0.48\linewidth]{isocontour/isocontour-optimized-plasma}}
	\subcaptionbox{diffusivity}
	{\includegraphics[width=0.48\linewidth]{isocontour/isocontour-optimized-diffusivity}}
	\caption{Isosurface errors for data-independent, \emph{isosurface-optimized}, and {\em isosurface
	signature} streams. The bit rates are capped to highlight differences among streams. The {\em by
	level} and {\em by magnitude} streams performs worst and the other remaining streams have similar
	performance.}\label{fig:isocontour-plots}
\end{figure}

Qualitatively, we studied isosurfaces at specific bit rates for all streams. We were especially
interested at bit rates where the error is not exponentially decaying - the low bit rate isosurfaces
do not resemble the reference full data set isosurfaces. For example, at bit rate 0.4 the error
curves are mostly flat and the gaps between them result in isosurfaces with visible differences
(\Cref{fig:isocontour-surfaces})).

\begin{figure}[t]
	\centering
	\subcaptionbox{\emph{by level}}
	{\includegraphics[width=0.31\linewidth]{isocontour/isocontour-level}}
	\subcaptionbox{\emph{by bit plane}}
	{\includegraphics[width=0.31\linewidth]{isocontour/isocontour-bit-plane}}
	\subcaptionbox{\emph{by wavelet norm}}
	{\includegraphics[width=0.31\linewidth]{isocontour/isocontour-wavelet-norm}}
	\subcaptionbox{\emph{by magnitude}}
	{\includegraphics[width=0.31\linewidth]{isocontour/isocontour-magnitude}}
	\subcaptionbox{\emph{by signature}}
	{\includegraphics[width=0.31\linewidth]{isocontour/isocontour-signature}}
	\subcaptionbox{\emph{groundtruth}}
	{\includegraphics[width=0.31\linewidth]{isocontour/isocontour-groundtruth}}
	\caption{Miranda pressure field isosurfaces at bitrate of 0.4 bps.\pavol{what isovalue?} Both {\em by level}
        and {\em by magnitude} stream exhibit severe blocking artifacts compared to the groundtruth.
        The other streams still show smear artifacts, but the overall structure of the isosurfaces
        is more round and closer to the reference.}
	\label{fig:isocontour-surfaces}
\end{figure}

\begin{figure}[t]
	\centering
	\subcaptionbox{\emph{reference}}
	{\includegraphics[width=0.31\linewidth]{isocontour/isocontour2-groundtruth}}
	\subcaptionbox{\emph{by bit plane}}
	{\includegraphics[width=0.31\linewidth]{isocontour/isocontour2-bit-plane}}
	\subcaptionbox{\emph{by wavelet norm}}
	{\includegraphics[width=0.31\linewidth]{isocontour/isocontour2-wavelet-norm}}
	\caption{Miranda pressure field isosurfaces at bitrate of 0.4 bps.\pavol{what isovalue?} Both {\em by level}
        and {\em by magnitude} stream exhibit severe blocking artifacts compared to the groundtruth.
        The other streams still show smear artifacts, but the overall structure of the isosurfaces
        is more round and closer to the reference.}
	\label{fig:isocontour-surfaces}
\end{figure}
%Figure 5: We show that the hybrid and isocontour can diverge somewhat for low-gradient contour.
%Valerio suggested here we coudl also build a "ramp" dataset at different angles and see if the two
%diverges more as the ramp become flatter.

%We argue that if the gradient is low, some noise bits at the end will make an impact, the isocontour
%is very sensitive to noise, and is in general not interesting or meaninfgul to extract.

In this section, we looked at isosurface results for all six streams. The {\em by level} and {\em by
magnitude} streams show blocking artifacts compared to the less severe smearing of {\em by wavelet
norm} and {\em by precisio} streams. Therefore, it seems that one of those latter streams combined
with a spatial adaptivity would perform well when isosurface extraction is desired.
